<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ComfyUI Web Interface</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="app-container">
        <!-- Collapsible Queue Sidebar -->
        <aside class="queue-sidebar" id="queueSidebar">
            <div class="queue-header">
                <h2>Queue <span id="queueCounter" class="queue-counter">0</span></h2>
                <div class="queue-header-actions">
                    <button class="btn-icon" id="unloadModelsBtn" title="Unload ComfyUI Models">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                            <line x1="12" y1="22.08" x2="12" y2="12"></line>
                        </svg>
                    </button>
                    <button class="btn-icon" id="clearQueueBtn" title="Clear Queue">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                    </button>
                    <button class="toggle-queue" id="toggleQueue" title="Toggle Queue">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Auto-unload countdown timer -->
            <div class="auto-unload-timer" id="autoUnloadTimer" style="display: none;">
                <div class="timer-icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                </div>
                <span id="timerText">Auto-unload in 5:00</span>
            </div>
            
            <div class="queue-content">
                <div class="queue-list" id="queueList">
                    <!-- Queued items will be displayed here -->
                </div>
                
                <div class="active-job" id="activeJob">
                    <!-- Active/generating job will be displayed here -->
                </div>
                
                <div class="completed-list" id="completedList">
                    <!-- Completed items will be displayed here -->
                </div>
                
                <div class="queue-empty" id="queueEmpty">
                    <p>Queue is empty</p>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="app-header">
                <button class="mobile-menu-btn" id="mobileMenuBtn" title="Toggle Menu">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <h1>ComfyUI Imaginer</h1>
            </header>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="single">Single</button>
                <button class="tab-btn" data-tab="browser">Browser</button>
            </div>

            <div class="content-wrapper">
                <!-- Single Generation Tab -->
                <section class="tab-content active" id="singleTab">
                    <div class="generation-panel">
                        <div class="form-group">
                            <label for="prompt">Prompt</label>
                            <div class="prompt-container">
                                <textarea 
                                    id="prompt" 
                                    rows="4" 
                                    placeholder="Enter your prompt here... (Ctrl+Enter to generate)"
                                    class="form-control"
                                ></textarea>
                                <button class="btn btn-primary btn-generate" id="generateBtn">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                    </svg>
                                    <span>Generate</span>
                                </button>
                            </div>
                            <button class="btn btn-sm" id="editPromptWithAI" style="margin-top: 0.5rem;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12 6 12 12 16 14"></polyline>
                                </svg>
                                <span>âœ¨ Edit with AI</span>
                            </button>
                        </div>

                        <button class="collapsible-header" data-target="singleParameters">
                            <span>Parameters</span>
                            <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="collapsible-content active" id="singleParameters">
                        <div class="parameters-grid">
                        <div class="form-group">
                            <label for="width">Width</label>
                            <input 
                                type="number" 
                                id="width" 
                                value="1024" 
                                min="64" 
                                max="2048" 
                                step="64"
                                class="form-control"
                            >
                        </div>

                        <div class="form-group">
                            <label for="height">Height</label>
                            <input 
                                type="number" 
                                id="height" 
                                value="1024" 
                                min="64" 
                                max="2048" 
                                step="64"
                                class="form-control"
                            >
                        </div>

                        <div class="form-group">
                            <label for="steps">Steps</label>
                            <input 
                                type="number" 
                                id="steps" 
                                value="4" 
                                min="1" 
                                max="100"
                                class="form-control"
                            >
                        </div>                        <div class="form-group">
                            <label for="seed">Seed (optional)</label>
                            <div class="input-with-clear">
                                <input 
                                    type="number" 
                                    id="seed" 
                                    placeholder="Random"
                                    class="form-control"
                                >
                                <button type="button" class="clear-btn" id="clearSeedBtn" title="Clear seed">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18"></line>
                                        <line x1="6" y1="6" x2="18" y2="18"></line>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="filePrefix">File Prefix (optional)</label>
                            <input 
                                type="text" 
                                id="filePrefix" 
                                placeholder="comfyui"
                                class="form-control"
                            >
                        </div>

                        <div class="form-group">
                            <label for="subfolder">Output Folder (optional)</label>
                            <input 
                                type="text" 
                                id="subfolder" 
                                placeholder="Leave empty for root"
                                class="form-control"
                            >
                        </div>
                        </div>

                        <button class="collapsible-header" data-target="loraSettings">
                            <span>LoRA Settings</span>
                            <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <div class="collapsible-content active" id="loraSettings">
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="mcnlLora" class="checkbox-input">
                                    <span>MCNL LoRA</span>
                                </label>
                                <div class="keyword-list">
                                    <small>Keywords: cum_on_face, nsfw, blowjob, cowgirlout, creamp1e, penis</small>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="snofsLora" class="checkbox-input">
                                    <span>Snofs LoRA</span>
                                </label>
                                <div class="keyword-list">
                                    <small>Keywords: anus, blowjob, deepthroat, braless, cowgirl position, cum, cunnilingus, dildo, doggystyle position, fingering, hand in panties, handjob, implied blowjob, ipcam, masturbating, massage, missionary position, naked, nude, penis, prone position, reverse cowgirl position, sex, sheer, snapchat, selfie, mirror selfie, spooning position, strap-on dildo, tentacles, licking testicles, undressing, vagina</small>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="ofaceLora" class="checkbox-input">
                                    <span>OFace LoRA</span>
                                </label>
                                <div class="keyword-list">
                                    <small>Keywords: having an orgasm</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                </section>

                <!-- Image Browser Tab -->
                <section class="tab-content" id="browserTab">
                    <div class="gallery-panel">
                    <div class="gallery-header">
                        <h2>Image Browser</h2>
                        <div class="gallery-toolbar">
                            <button class="btn btn-sm" id="newFolderBtn" title="New Folder">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                                    <line x1="12" y1="11" x2="12" y2="17"></line>
                                    <line x1="9" y1="14" x2="15" y2="14"></line>
                                </svg>
                                <span>Create Folder</span>
                            </button>
                            <button class="btn btn-sm" id="setOutputFolderBtn" title="Set as Output Folder">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                <span>Set Output Folder</span>
                            </button>
                            <button class="btn btn-sm" id="selectionModeBtn" title="Toggle Selection Mode">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 11l3 3L22 4"></path>
                                    <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                                </svg>
                                <span>Select</span>
                            </button>
                            <button class="btn btn-sm" id="moveBtn" title="Move Selected" style="display:none;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="5 9 2 12 5 15"></polyline>
                                    <polyline points="9 5 12 2 15 5"></polyline>
                                    <polyline points="15 19 12 22 9 19"></polyline>
                                    <polyline points="19 9 22 12 19 15"></polyline>
                                    <line x1="2" y1="12" x2="22" y2="12"></line>
                                    <line x1="12" y1="2" x2="12" y2="22"></line>
                                </svg>
                                <span>Move Selected</span>
                            </button>
                            <button class="btn btn-sm btn-danger" id="deleteBtn" title="Delete Selected" style="display:none;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                </svg>
                                <span>Delete Selected</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="breadcrumb" id="breadcrumb">
                        <!-- Breadcrumb navigation -->
                    </div>
                    
                    <div class="gallery-grid" id="galleryGrid">
                        <!-- Images and folders will be loaded here -->
                    </div>
                    
                    <div class="gallery-empty" id="galleryEmpty">
                        <p>No items in this folder</p>
                    </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Image Detail Modal -->
    <div class="modal" id="imageModal">
        <div class="modal-overlay" id="imageOverlay"></div>
        <div class="modal-content image-detail-content">
            <button class="modal-close" id="closeImageBtn">Ã—</button>
            
            <div class="image-detail">
                <button class="image-nav prev" id="imagePrev">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
                
                <div class="image-detail-center">
                    <img id="detailImage" alt="Generated Image">
                    <span class="image-counter" id="imageCounter">0 / 0</span>
                    <div class="image-actions">
                        <button class="btn btn-primary import-btn" id="importBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Import to Form
                        </button>
                        <button class="btn btn-secondary" id="fullscreenBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
                            </svg>
                            Fullscreen
                        </button>
                        <button class="btn btn-danger" id="deleteImageBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                            Delete Image
                        </button>
                    </div>
                    <div class="image-metadata" id="imageMetadata">
                        <!-- Metadata will be displayed here -->
                    </div>
                </div>
                
                <button class="image-nav next" id="imageNext">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Custom Dialog Modal -->
    <div class="custom-modal" id="customDialog" style="display: none;">
        <div class="custom-modal-overlay"></div>
        <div class="custom-modal-content">
            <h3 id="dialogTitle"></h3>
            <div id="dialogMessage"></div>
            <div id="dialogInput" style="display: none;">
                <input type="text" id="dialogInputField" class="form-control" placeholder="">
            </div>
            <div class="custom-modal-actions">
                <button class="btn btn-secondary" id="dialogCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="dialogConfirmBtn">OK</button>
            </div>
        </div>
    </div>

    <!-- Custom Alert Modal -->
    <div class="custom-modal" id="customAlert" style="display: none;">
        <div class="custom-modal-overlay"></div>
        <div class="custom-modal-content">
            <h3 id="alertTitle">Notice</h3>
            <div id="alertMessage"></div>
            <div class="custom-modal-actions">
                <button class="btn btn-primary" id="alertOkBtn">OK</button>
            </div>
        </div>
    </div>

    <!-- Fullscreen Image Viewer -->
    <div class="fullscreen-viewer" id="fullscreenViewer">
        <div class="fullscreen-controls" id="fullscreenControls">
            <div class="fullscreen-counter" id="fullscreenCounter">0 / 0</div>
            
            <!-- Zoom Controls -->
            <div class="fullscreen-zoom-controls">
                <button class="fullscreen-control-btn" id="fullscreenZoomOut" title="Zoom Out (-)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        <line x1="8" y1="11" x2="14" y2="11"></line>
                    </svg>
                </button>
                <span class="fullscreen-zoom-level" id="fullscreenZoomLevel">100%</span>
                <button class="fullscreen-control-btn" id="fullscreenZoomIn" title="Zoom In (+)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        <line x1="11" y1="8" x2="11" y2="14"></line>
                        <line x1="8" y1="11" x2="14" y2="11"></line>
                    </svg>
                </button>
                <button class="fullscreen-control-btn" id="fullscreenZoomReset" title="Reset Zoom (0)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                </button>
            </div>
            
            <!-- Autoplay Controls -->
            <div class="fullscreen-autoplay-controls">
                <button class="fullscreen-control-btn" id="fullscreenPlayPause" title="Play/Pause (Space)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="play-icon">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="pause-icon" style="display: none;">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg>
                </button>
                <input type="number" id="fullscreenAutoplayInterval" class="fullscreen-interval-input" value="3" min="1" max="60" step="0.5" title="Autoplay interval (seconds)">
                <span style="color: white; font-size: 0.9rem;">s</span>
            </div>
            
            <button class="fullscreen-close" id="fullscreenClose">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <button class="fullscreen-nav fullscreen-prev" id="fullscreenPrev">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>
            <button class="fullscreen-nav fullscreen-next" id="fullscreenNext">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </button>
        </div>
        <div class="fullscreen-image-container" id="fullscreenImageContainer">
            <img id="fullscreenImage" alt="Fullscreen Image">
        </div>
    </div>

    <!-- Toast Notifications Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- AI Edit Modal -->
    <div class="custom-modal" id="aiEditModal" style="display: none;">
        <div class="custom-modal-overlay"></div>
        <div class="custom-modal-content" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
            <h3>âœ¨ AI Prompt Editor</h3>
            
            <!-- Model Selection -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiProvider">AI Provider</label>
                <select id="aiProvider" class="form-control" style="margin-bottom: 0.5rem;">
                    <option value="ollama">Ollama (Local)</option>
                    <option value="gemini">Google Gemini</option>
                </select>
                
                <label for="aiModel">Model</label>
                <select id="aiModel" class="form-control">
                    <option value="">Loading models...</option>
                </select>
                <small style="color: var(--text-muted); display: block; margin-top: 0.25rem;">
                    <span id="modelInfo">Select a provider to load models</span>
                </small>
            </div>
            
            <!-- Current Prompt -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiCurrentPrompt">Current Prompt</label>
                <textarea 
                    id="aiCurrentPrompt" 
                    rows="4" 
                    class="form-control"
                    placeholder="Your prompt will appear here..."
                    readonly
                    style="background: var(--bg-secondary); cursor: default;"
                ></textarea>
            </div>
            
            <!-- Action Buttons -->
            <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem;">
                <button class="btn btn-primary" id="aiOptimizeBtn" style="flex: 1;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Optimize Prompt
                </button>
                <button class="btn btn-secondary" id="aiCopyPromptBtn" title="Copy to clipboard">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Suggestion Input -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiSuggestion">Custom Suggestion (optional)</label>
                <div style="display: flex; gap: 0.5rem;">
                    <input 
                        type="text" 
                        id="aiSuggestion" 
                        class="form-control" 
                        placeholder="e.g., make it more dramatic, add sunset lighting..."
                        style="flex: 1;"
                    >
                    <button class="btn btn-primary" id="aiApplySuggestionBtn">
                        Apply
                    </button>
                </div>
                <small style="color: var(--text-muted); display: block; margin-top: 0.25rem;">
                    Enter specific changes you want to make to the prompt
                </small>
            </div>
            
            <!-- Result Area -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiResult">AI Result</label>
                <textarea 
                    id="aiResult" 
                    rows="6" 
                    class="form-control"
                    placeholder="AI-generated prompt will appear here..."
                ></textarea>
                <div id="aiLoadingIndicator" style="display: none; margin-top: 0.5rem; color: var(--primary);">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="animation: spin 1s linear infinite; display: inline-block;">
                        <circle cx="12" cy="12" r="10" stroke-opacity="0.25"></circle>
                        <path d="M12 2 A10 10 0 0 1 22 12" stroke-opacity="0.75"></path>
                    </svg>
                    <span style="margin-left: 0.5rem;">AI is thinking...</span>
                </div>
            </div>
            
            <!-- Modal Actions -->
            <div class="custom-modal-actions">
                <button class="btn btn-secondary" id="aiModalCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="aiModalUseBtn">Use This Prompt</button>
            </div>
        </div>
    </div>

    <!-- AI Parameter Generator Modal -->
    <div class="custom-modal" id="aiParameterModal" style="display: none;">
        <div class="custom-modal-overlay"></div>
        <div class="custom-modal-content" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
            <h3>ðŸ¤– AI Parameter Generator</h3>
            
            <!-- Model Selection -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiParamProvider">AI Provider</label>
                <select id="aiParamProvider" class="form-control" style="margin-bottom: 0.5rem;">
                    <option value="ollama">Ollama (Local)</option>
                    <option value="gemini">Google Gemini</option>
                </select>
                
                <label for="aiParamModel">Model</label>
                <select id="aiParamModel" class="form-control">
                    <option value="">Loading models...</option>
                </select>
            </div>
            
            <!-- Count -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiParamCount">Number of Variations</label>
                <input 
                    type="number" 
                    id="aiParamCount" 
                    value="5" 
                    min="1" 
                    max="50"
                    class="form-control"
                >
                <small style="color: var(--text-muted); display: block; margin-top: 0.25rem;">
                    Generate 1-50 parameter variations
                </small>
            </div>
            
            <!-- Context Type -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label>Context to Send</label>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <label class="checkbox-label" style="cursor: pointer;">
                        <input type="radio" name="aiContextType" value="full" checked style="margin-right: 0.5rem;">
                        <span>Template + Custom Context (below)</span>
                    </label>
                    <label class="checkbox-label" style="cursor: pointer;">
                        <input type="radio" name="aiContextType" value="parameters" style="margin-right: 0.5rem;">
                        <span>Parameters Only + Custom Context</span>
                    </label>
                    <label class="checkbox-label" style="cursor: pointer;">
                        <input type="radio" name="aiContextType" value="custom" style="margin-right: 0.5rem;">
                        <span>Custom Context Only</span>
                    </label>
                </div>
            </div>
            
            <!-- Custom Context -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiParamContext">Custom Context / Instructions</label>
                <textarea 
                    id="aiParamContext" 
                    rows="4" 
                    class="form-control"
                    placeholder="e.g., Focus on fantasy themes, Use vibrant colors, Include various times of day..."
                ></textarea>
                <small style="color: var(--text-muted); display: block; margin-top: 0.25rem;">
                    Provide additional context or instructions for parameter generation
                </small>
            </div>
            
            <!-- Generate Button -->
            <button class="btn btn-primary btn-large" id="aiGenerateParamsBtn" style="width: 100%; margin-bottom: 1rem;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                Generate Parameters
            </button>
            
            <!-- Result Area -->
            <div class="form-group" style="margin-bottom: 1.5rem;">
                <label for="aiParamResult">Generated CSV Data</label>
                <textarea 
                    id="aiParamResult" 
                    rows="10" 
                    class="form-control"
                    placeholder="Generated CSV data will appear here..."
                    style="font-family: monospace; font-size: 0.9rem;"
                ></textarea>
                <div id="aiParamLoadingIndicator" style="display: none; margin-top: 0.5rem; color: var(--primary);">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="animation: spin 1s linear infinite; display: inline-block;">
                        <circle cx="12" cy="12" r="10" stroke-opacity="0.25"></circle>
                        <path d="M12 2 A10 10 0 0 1 22 12" stroke-opacity="0.75"></path>
                    </svg>
                    <span style="margin-left: 0.5rem;">AI is generating parameters...</span>
                </div>
            </div>
            
            <!-- Modal Actions -->
            <div class="custom-modal-actions">
                <button class="btn btn-secondary" id="aiParamModalCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="aiParamModalUseBtn">Use This Data</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
